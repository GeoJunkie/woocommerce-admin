(window.__wcAdmin_webpackJsonp=window.__wcAdmin_webpackJsonp||[]).push([[51],{514:function(e,t,o){"use strict";o.r(t),o.d(t,"UsageModal",(function(){return l}));var c=o(0),n=o(2),a=o(12),s=o(18),i=o.n(s),r=o(21),m=o(510);const l=()=>{const e="1"===Object(a.getQuery)()["wcpay-connection-success"],[t,o]=Object(c.useState)(e);if(!t)return null;const s=()=>{o(!1),Object(a.updateQueryString)({"wcpay-connection-success":void 0})},l=Object(n.__)("Help us build a better WooCommerce Payments experience","woocommerce-admin"),d=i()({mixedString:Object(n.__)("By agreeing to share non-sensitive {{link}}usage data{{/link}}, youâ€™ll help us improve features and optimize the WooCommerce Payments experience. You can opt out at any time.","woocommerce-admin"),components:{link:Object(c.createElement)(r.Link,{href:"https://woocommerce.com/usage-tracking?utm_medium=product",target:"_blank",type:"external"})}});return Object(c.createElement)(m.a,{isDismissible:!1,title:l,message:d,acceptActionText:Object(n.__)("I agree","woocommerce-admin"),dismissActionText:Object(n.__)("No thanks","woocommerce-admin"),onContinue:s,onClose:s})};t.default=l},522:function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));var c=o(0),n=o(2),a=o(3),s=o(12),i=o(16);const r=({hasSetup:e=!1,needsSetup:t=!0,id:o,isEnabled:r=!1,isLoading:m=!1,isInstalled:l=!1,isRecommended:d=!1,hasPlugins:p,manageUrl:u=null,markConfigured:_,onSetUp:b=(()=>{}),onSetupCallback:g,setupButtonText:O=Object(n.__)("Set up","woocommerce-admin")})=>{const[h,j]=Object(c.useState)(!1),w="woocommerce-task-payment__action";if(m)return Object(c.createElement)(a.Spinner,null);const y=async()=>{if(b(o),g)return j(!0),void await new Promise(g).then(()=>{j(!1)}).catch(()=>{j(!1)});Object(s.updateQueryString)({id:o})},k=()=>Object(c.createElement)(a.Button,{className:w,isSecondary:!0,role:"button",href:u,onClick:()=>Object(i.recordEvent)("tasklist_payment_manage",{id:o})},Object(n.__)("Manage","woocommerce-admin")),E=()=>Object(c.createElement)(a.Button,{className:w,isPrimary:d,isSecondary:!d,isBusy:h,disabled:h,onClick:()=>y()},O);return e?p?t?l&&p?Object(c.createElement)("div",null,Object(c.createElement)(a.Button,{className:w,isPrimary:d,isSecondary:!d,isBusy:h,disabled:h,onClick:()=>y()},Object(n.__)("Finish setup","woocommerce-admin"))):Object(c.createElement)(E,null):Object(c.createElement)(k,null):r?Object(c.createElement)(k,null):Object(c.createElement)(E,null):r?Object(c.createElement)(k,null):Object(c.createElement)(a.Button,{className:w,isSecondary:!0,onClick:()=>_(o)},Object(n.__)("Enable","woocommerce-admin"))}},523:function(e,t,o){"use strict";o.d(t,"b",(function(){return m})),o.d(t,"c",(function(){return l})),o.d(t,"a",(function(){return j}));var c=o(2),n=o(17),a=o.n(n),s=o(11),i=o(16),r=o(504);function m(e,t,o){const n=Object(c.__)("There was an error connecting to WooCommerce Payments. Please try again or connect later in store settings.","woocommerce-admin");o(["woocommerce-payments"]).then(()=>{Object(i.recordEvent)("woocommerce_payments_install",{context:"tasklist"}),a()({path:s.WC_ADMIN_NAMESPACE+"/plugins/connect-wcpay",method:"POST"}).then(e=>{window.location=e.connectUrl}).catch(()=>{t("error",n),e()})}).catch(t=>{Object(r.a)(t),e()})}function l(e){return["US","PR","AU","CA","DE","ES","FR","GB","IE","IT","NZ","AT","BE","NL","PL","PT","CH","HK","SG"].includes(e)}var d=o(0),p=o(18),u=o.n(p),_=o(21),b=o(20),g=o(271),O=o(522);const h=()=>u()({mixedString:Object(c.__)('Upon clicking "Get started", you agree to the {{link}}Terms of service{{/link}}. Next weâ€™ll ask you to share a few details about your business to create your account.',"woocommerce-admin"),components:{link:Object(d.createElement)(_.Link,{href:"https://wordpress.com/tos/",target:"_blank",type:"external"})}}),j=({paymentGateway:e,onSetupCallback:t=null})=>{const{description:o,id:n,needsSetup:a,installed:s,enabled:r,installed:m}=e;return Object(d.createElement)(g.WCPayCard,null,Object(d.createElement)(g.WCPayCardHeader,null,s&&a?Object(d.createElement)(g.SetupRequired,null):Object(d.createElement)(_.Pill,null,Object(c.__)("Recommended","woocommerce-admin"))),Object(d.createElement)(g.WCPayCardBody,{description:o,onLinkClick:()=>{Object(i.recordEvent)("tasklist_payment_learn_more")}}),Object(d.createElement)(g.WCPayCardFooter,null,Object(d.createElement)(d.Fragment,null,Object(d.createElement)(b.Text,{lineHeight:"1.5em"},Object(d.createElement)(h,null)),Object(d.createElement)(O.a,{id:n,hasSetup:!0,needsSetup:a,isEnabled:r,isRecommended:!0,isInstalled:m,hasPlugins:!0,setupButtonText:Object(c.__)("Get started","woocommerce-admin"),onSetupCallback:t}))))};o(514)},531:function(e,t,o){"use strict";o.d(t,"a",(function(){return c})),o.d(t,"b",(function(){return n}));const c=(e,t,o="undefined")=>e&&Array.isArray(e)&&e.length?t?e.reduce((e,c)=>(c[t]||(c[t]=o),(e[c[t]]=e[c[t]]||[]).push(c),e),{}):e:{},n=(e,t)=>Object.entries(e).reduce((e,[o])=>({...e,[o]:t}),{})},542:function(e,t,o){},603:function(e,t,o){},604:function(e,t,o){},605:function(e,t,o){},606:function(e,t,o){},607:function(e,t,o){},608:function(e,t,o){},628:function(e,t,o){"use strict";o.r(t);var c=o(0),n=o(2),a=o(3),s=o(475),i=o(7),r=o(11),m=o(121),l=o(16),d=o(21),p=(o(544),o(546)),u=o(30),_=o(12),b=o(17),g=o.n(b),O=o(14),h=o(4);class j extends c.Component{constructor(e){super(e);const{hasHomepage:t,hasProducts:o}=e.tasksStatus;this.stepVisibility={homepage:!t,import:!o},this.state={isDirty:!1,isPending:!1,logo:null,stepIndex:0,isUpdatingLogo:!1,isUpdatingNotice:!1,storeNoticeText:e.demoStoreNotice||""},this.completeStep=this.completeStep.bind(this),this.createHomepage=this.createHomepage.bind(this),this.importProducts=this.importProducts.bind(this),this.updateLogo=this.updateLogo.bind(this),this.updateNotice=this.updateNotice.bind(this)}componentDidMount(){const{themeMods:e}=this.props.tasksStatus;e&&e.custom_logo&&this.setState({logo:{id:e.custom_logo}})}componentDidUpdate(e){const{isPending:t,logo:o}=this.state,{demoStoreNotice:c}=this.props;!o||o.url||t||(this.setState({isPending:!0}),wp.media.attachment(o.id).fetch().then(()=>{const e=wp.media.attachment(o.id).get("url");this.setState({isPending:!1,logo:{id:o.id,url:e}})})),c&&e.demoStoreNotice!==c&&this.setState({storeNoticeText:c})}completeStep(){const{stepIndex:e}=this.state;this.getSteps()[e+1]?this.setState({stepIndex:e+1}):Object(_.getHistory)().push(Object(_.getNewPath)({},"/",{}))}importProducts(){const{clearTaskStatusCache:e,createNotice:t}=this.props;this.setState({isPending:!0}),Object(l.recordEvent)("tasklist_appearance_import_demo",{}),g()({path:r.WC_ADMIN_NAMESPACE+"/onboarding/tasks/import_sample_products",method:"POST"}).then(o=>{o.failed&&o.failed.length?t("error",Object(n.__)("There was an error importing some of the sample products","woocommerce-admin")):(t("success",Object(n.__)("All sample products have been imported","woocommerce-admin")),e()),this.setState({isPending:!1}),this.completeStep()}).catch(e=>{t("error",e.message),this.setState({isPending:!1})})}createHomepage(){const{clearTaskStatusCache:e,createNotice:t}=this.props;this.setState({isPending:!0}),Object(l.recordEvent)("tasklist_appearance_create_homepage",{create_homepage:!0}),g()({path:"/wc-admin/onboarding/tasks/create_homepage",method:"POST"}).then(o=>{e(),t(o.status,o.message,{actions:o.edit_post_link?[{label:Object(n.__)("Customize","woocommerce-admin"),onClick:()=>{Object(l.queueRecordEvent)("tasklist_appearance_customize_homepage",{}),window.location=o.edit_post_link+"&wc_onboarding_active_task=homepage"}}]:null}),this.setState({isPending:!1}),this.completeStep()}).catch(e=>{t("error",e.message),this.setState({isPending:!1})})}async updateLogo(){const{clearTaskStatusCache:e,createNotice:t,stylesheet:o,themeMods:c,updateOptions:a}=this.props,{logo:s}=this.state,i={...c,custom_logo:s?s.id:null};Object(l.recordEvent)("tasklist_appearance_upload_logo"),this.setState({isUpdatingLogo:!0});const r=await a({["theme_mods_"+o]:i});e(),r.success?(this.setState({isUpdatingLogo:!1}),t("success",Object(n.__)("Store logo updated sucessfully","woocommerce-admin")),this.completeStep()):t("error",r.message)}async updateNotice(){const{clearTaskStatusCache:e,createNotice:t,updateOptions:o}=this.props,{storeNoticeText:c}=this.state;Object(l.recordEvent)("tasklist_appearance_set_store_notice",{added_text:Boolean(c.length)}),this.setState({isUpdatingNotice:!0});const a=await o({woocommerce_task_list_appearance_complete:!0,woocommerce_demo_store:c.length?"yes":"no",woocommerce_demo_store_notice:c});e(),a.success?(this.setState({isUpdatingNotice:!1}),t("success",Object(n.__)("ðŸŽ¨ Your store is looking great! Don't forget to continue personalizing it","woocommerce-admin")),this.completeStep()):t("error",a.message)}getSteps(){const{isDirty:e,isPending:t,logo:o,storeNoticeText:s,isUpdatingLogo:i}=this.state,r=[{key:"import",label:Object(n.__)("Import sample products","woocommerce-admin"),description:Object(n.__)("Weâ€™ll add some products that will make it easier to see what your store looks like","woocommerce-admin"),content:Object(c.createElement)(c.Fragment,null,Object(c.createElement)(a.Button,{onClick:this.importProducts,isBusy:t,isPrimary:!0},Object(n.__)("Import products","woocommerce-admin")),Object(c.createElement)(a.Button,{onClick:()=>this.completeStep()},Object(n.__)("Skip","woocommerce-admin"))),visible:this.stepVisibility.import},{key:"homepage",label:Object(n.__)("Create a custom homepage","woocommerce-admin"),description:Object(n.__)("Create a new homepage and customize it to suit your needs","woocommerce-admin"),content:Object(c.createElement)(c.Fragment,null,Object(c.createElement)(a.Button,{isPrimary:!0,isBusy:t,onClick:this.createHomepage},Object(n.__)("Create homepage","woocommerce-admin")),Object(c.createElement)(a.Button,{isTertiary:!0,onClick:()=>{Object(l.recordEvent)("tasklist_appearance_create_homepage",{create_homepage:!1}),this.completeStep()}},Object(n.__)("Skip","woocommerce-admin"))),visible:this.stepVisibility.homepage},{key:"logo",label:Object(n.__)("Upload a logo","woocommerce-admin"),description:Object(n.__)("Ensure your store is on-brand by adding your logo","woocommerce-admin"),content:t?null:Object(c.createElement)(c.Fragment,null,Object(c.createElement)(d.ImageUpload,{image:o,onChange:e=>this.setState({isDirty:!0,logo:e})}),Object(c.createElement)(a.Button,{disabled:!o&&!e,onClick:this.updateLogo,isBusy:i,isPrimary:!0},Object(n.__)("Proceed","woocommerce-admin")),Object(c.createElement)(a.Button,{isTertiary:!0,onClick:()=>this.completeStep()},Object(n.__)("Skip","woocommerce-admin"))),visible:!0},{key:"notice",label:Object(n.__)("Set a store notice","woocommerce-admin"),description:Object(n.__)("Optionally display a prominent notice across all pages of your store","woocommerce-admin"),content:Object(c.createElement)(c.Fragment,null,Object(c.createElement)(d.TextControl,{label:Object(n.__)("Store notice text","woocommerce-admin"),placeholder:Object(n.__)("Store notice text","woocommerce-admin"),value:s,onChange:e=>this.setState({storeNoticeText:e})}),Object(c.createElement)(a.Button,{onClick:this.updateNotice,isPrimary:!0},Object(n.__)("Complete task","woocommerce-admin"))),visible:!0}];return Object(h.filter)(r,e=>e.visible)}render(){const{isPending:e,stepIndex:t,isUpdatingLogo:o,isUpdatingNotice:n}=this.state,s=this.getSteps()[t].key;return Object(c.createElement)("div",{className:"woocommerce-task-appearance"},Object(c.createElement)(a.Card,{className:"woocommerce-task-card"},Object(c.createElement)(a.CardBody,null,Object(c.createElement)(d.Stepper,{isPending:n||o||e,isVertical:!0,currentStep:s,steps:this.getSteps()}))))}}var w=Object(O.compose)(Object(i.withSelect)(e=>{const{getOption:t}=e(r.OPTIONS_STORE_NAME),{getTasksStatus:o}=e(r.ONBOARDING_STORE_NAME),c=o();return{demoStoreNotice:t("woocommerce_demo_store_notice"),stylesheet:t("stylesheet"),tasksStatus:c}}),Object(i.withDispatch)(e=>{const{createNotice:t}=e("core/notices"),{updateOptions:o}=e(r.OPTIONS_STORE_NAME),{invalidateResolutionForStoreSelector:c}=e(r.ONBOARDING_STORE_NAME);return{clearTaskStatusCache:()=>c("getTasksStatus"),createNotice:t,updateOptions:o}}))(j),y=o(60),k=o(20),E=(o(603),o(504)),S=o(13);o(604);const f=({description:e,imageUrl:t,installAndActivate:o=(()=>{}),isActive:s,isBusy:i,isDisabled:r,isInstalled:m,manageUrl:d,name:p,slug:u})=>Object(c.createElement)("div",{className:"woocommerce-plugin-list__plugin"},t&&Object(c.createElement)("div",{className:"woocommerce-plugin-list__plugin-logo"},Object(c.createElement)("img",{src:t,alt:Object(n.sprintf)(Object(n.__)("%s logo","woocommerce-admin"),p)})),Object(c.createElement)("div",{className:"woocommerce-plugin-list__plugin-text"},Object(c.createElement)(k.Text,{variant:"subtitle.small",as:"h4"},p),Object(c.createElement)(k.Text,{variant:"subtitle.small"},e)),Object(c.createElement)("div",{className:"woocommerce-plugin-list__plugin-action"},s&&d&&Object(c.createElement)(a.Button,{disabled:r,isBusy:i,isSecondary:!0,href:Object(S.e)(d),onClick:()=>Object(l.recordEvent)("marketing_manage",{extension_name:u})},Object(n.__)("Manage","woocommmerce-admin")),m&&!s&&Object(c.createElement)(a.Button,{disabled:r,isBusy:i,isSecondary:!0,onClick:()=>o(u)},Object(n.__)("Activate","woocommmerce-admin")),!m&&Object(c.createElement)(a.Button,{disabled:r,isBusy:i,isSecondary:!0,onClick:()=>o(u)},Object(n.__)("Get started","woocommmerce-admin"))));o(605);const v=({currentPlugin:e,installAndActivate:t=(()=>{}),plugins:o=[],title:n})=>Object(c.createElement)("div",{className:"woocommerce-plugin-list"},n&&Object(c.createElement)("div",{className:"woocommerce-plugin-list__title"},Object(c.createElement)(k.Text,{variant:"sectionheading",as:"h3"},n)),o.map(o=>{const{description:n,imageUrl:a,isActive:s,isInstalled:i,manageUrl:r,slug:m,name:l}=o;return Object(c.createElement)(f,{key:m,description:n,manageUrl:r,name:l,imageUrl:a,installAndActivate:t,isActive:s,isBusy:e===m,isDisabled:!!e,isInstalled:i,slug:m})})),C=["reach","grow"],T=(e,t,o)=>{const c=[],n=[];return e.forEach(e=>{if(!C.includes(e.key))return;const a=[];if(e.plugins.forEach(e=>{const n=((e,t,o)=>{const{description:c,image_url:n,key:a,manage_url:s,name:i}=e,r=a.split(":")[0];return{description:c,slug:r,imageUrl:n,isActive:t.includes(r),isInstalled:o.includes(r),manageUrl:s,name:i}})(e,t,o);n.isInstalled?c.push(n):a.push(n)}),!a.length)return;const s={...e,plugins:a};n.push(s)}),[c,n]},x=({trackedCompletedActions:e})=>{const[t,o]=Object(c.useState)(null),{installAndActivatePlugins:s}=Object(i.useDispatch)(r.PLUGINS_STORE_NAME),{updateOptions:m}=Object(i.useDispatch)(r.OPTIONS_STORE_NAME),{activePlugins:d,freeExtensions:p,installedPlugins:u,isResolving:_}=Object(i.useSelect)(e=>{const{getActivePlugins:t,getInstalledPlugins:o}=e(r.PLUGINS_STORE_NAME),{getFreeExtensions:c,hasFinishedResolution:n}=e(r.ONBOARDING_STORE_NAME);return{activePlugins:t(),freeExtensions:c(),installedPlugins:o(),isResolving:!n("getFreeExtensions")}}),[b,g]=Object(c.useMemo)(()=>T(p,d,u),[u,d,p]),O=t=>{o(t),s([t]).then(c=>{Object(l.recordEvent)("tasklist_marketing_install",{selected_extension:t,installed_extensions:b.map(e=>e.slug)}),e.includes("marketing")||m({woocommerce_task_list_tracked_completed_actions:[...e,"marketing"]}),Object(E.a)(c),o(null)}).catch(e=>{Object(E.a)(e),o(null)})};return _?Object(c.createElement)(a.Spinner,null):Object(c.createElement)("div",{className:"woocommerce-task-marketing"},!!b.length&&Object(c.createElement)(a.Card,{className:"woocommerce-task-card"},Object(c.createElement)(a.CardHeader,null,Object(c.createElement)(k.Text,{variant:"title.small",as:"h2",className:"woocommerce-task-card__title"},Object(n.__)("Installed marketing extensions","woocommerce-admin"))),Object(c.createElement)(v,{currentPlugin:t,plugins:b})),!!g.length&&Object(c.createElement)(a.Card,{className:"woocommerce-task-card"},Object(c.createElement)(a.CardHeader,null,Object(c.createElement)(k.Text,{variant:"title.small",as:"h2",className:"woocommerce-task-card__title"},Object(n.__)("Recommended marketing extensions","woocommerce-admin")),Object(c.createElement)(k.Text,{as:"span"},Object(n.__)('We recommend adding one of the following marketing tools for your store. The extension will be installed and activated for you when you click "Get started".',"woocommerce-admin"))),g.map(e=>{const{key:o,title:n,plugins:a}=e;return Object(c.createElement)(v,{currentPlugin:t,installAndActivate:O,key:o,plugins:a,title:n})})))};var N=o(116),P=o(619),A=o(473),I=o(620),R=o(621),M=o(622);o(606);const B=[{key:"physical",title:Object(n.__)("Physical product","woocommerce-admin"),subtitle:Object(n.__)("Tangible items that get delivered to customers","woocommerce-admin")},{key:"digital",title:Object(n.__)("Digital product","woocommerce-admin"),subtitle:Object(n.__)("Items that customers download or access through your website","woocommerce-admin")},{key:"variable",title:Object(n.__)("Variable product","woocommerce-admin"),subtitle:Object(n.__)("Products with several versions that customers can choose from","woocommerce-admin")}];function G({onClose:e}){const[t,o]=Object(c.useState)(null),[s,m]=Object(c.useState)(!1),{createProductFromTemplate:d}=Object(i.useDispatch)(r.ITEMS_STORE_NAME),p=Object(u.applyFilters)("woocommerce_admin_onboarding_product_templates",B);return Object(c.createElement)(a.Modal,{title:Object(n.__)("Start with a template"),isDismissible:!0,onRequestClose:()=>e(),className:"woocommerce-product-template-modal"},Object(c.createElement)("div",{className:"woocommerce-product-template-modal__wrapper"},Object(c.createElement)("div",{className:"woocommerce-product-template-modal__list"},Object(c.createElement)(a.RadioControl,{selected:t,options:p.map(e=>({label:Object(c.createElement)(c.Fragment,null,Object(c.createElement)("span",{className:"woocommerce-product-template-modal__list-title"},e.title),Object(c.createElement)("span",{className:"woocommerce-product-template-modal__list-subtitle"},e.subtitle)),value:e.key})),onChange:o})),Object(c.createElement)("div",{className:"woocommerce-product-template-modal__actions"},Object(c.createElement)(a.Button,{isPrimary:!0,isBusy:s,disabled:!t||s,onClick:()=>{m(!0),Object(l.recordEvent)("tasklist_product_template_selection",{product_type:t}),t?d({template_name:t,status:"draft"},{_fields:["id"]}).then(e=>{if(e&&e.id){const t=Object(S.e)(`post.php?post=${e.id}&action=edit&wc_onboarding_active_task=products&tutorial=true`);window.location=t}},e=>{Object(E.a)(e),m(!1)}):e&&(Object(l.recordEvent)("tasklist_product_template_dismiss"),e())}},Object(n.__)("Go")))))}const F=[{key:"addProductTemplate",title:Object(c.createElement)(c.Fragment,null,Object(n.__)("Start with a template","woocommerce-admin"),Object(c.createElement)(d.Pill,null,Object(n.__)("Recommended","woocommerce-admin"))),content:Object(n.__)("Use a template to add physical, digital, and variable products","woocommerce-admin"),before:Object(c.createElement)(N.a,{icon:P.a}),after:Object(c.createElement)(N.a,{icon:A.a}),onClick:()=>Object(l.recordEvent)("tasklist_add_product",{method:"product_template"})},{key:"addProductManually",title:Object(n.__)("Add manually","woocommerce-admin"),content:Object(n.__)("For small stores we recommend adding products manually","woocommerce-admin"),before:Object(c.createElement)(N.a,{icon:I.a}),after:Object(c.createElement)(N.a,{icon:A.a}),onClick:()=>Object(l.recordEvent)("tasklist_add_product",{method:"manually"}),href:Object(S.e)("post-new.php?post_type=product&wc_onboarding_active_task=products&tutorial=true")},{key:"importProducts",title:Object(n.__)("Import via CSV","woocommerce-admin"),content:Object(n.__)("For larger stores we recommend importing all products at once via CSV file","woocommerce-admin"),before:Object(c.createElement)(N.a,{icon:R.a}),after:Object(c.createElement)(N.a,{icon:A.a}),onClick:()=>Object(l.recordEvent)("tasklist_add_product",{method:"import"}),href:Object(S.e)("edit.php?post_type=product&page=product_importer&wc_onboarding_active_task=product-import")},{key:"migrateProducts",title:Object(n.__)("Import from another service","woocommerce-admin"),content:Object(n.__)("For stores currently selling elsewhere we suggest using a product migration service","woocommerce-admin"),before:Object(c.createElement)(N.a,{icon:M.a}),after:Object(c.createElement)(N.a,{icon:A.a}),onClick:()=>Object(l.recordEvent)("tasklist_add_product",{method:"migrate"}),href:"https://woocommerce.com/products/cart2cart/?utm_medium=product",target:"_blank"}];function L(){const[e,t]=Object(c.useState)(null),o=F.map(e=>({...e,onClick:()=>(e=>{e.onClick(),"addProductTemplate"===e.key&&t(!0)})(e)}));return Object(c.createElement)(c.Fragment,null,Object(c.createElement)(a.Card,{className:"woocommerce-task-card"},Object(c.createElement)(a.CardBody,{size:null},Object(c.createElement)(d.List,{items:o}))),e?Object(c.createElement)(G,{onClose:()=>t(null)}):null)}var U=o(35),D=o.n(U),q=o(18),H=o.n(q),W=o(519),J=o(520);class z extends c.Component{constructor(){super(...arguments),this.onSubmit=this.onSubmit.bind(this)}async onSubmit(e){const{onComplete:t,createNotice:o,isSettingsError:c,updateAndPersistSettingsForGroup:a,settings:s}=this.props;await a("general",{general:{...s,woocommerce_store_address:e.addressLine1,woocommerce_store_address_2:e.addressLine2,woocommerce_default_country:e.countryState,woocommerce_store_city:e.city,woocommerce_store_postcode:e.postCode}}),c?o("error",Object(n.__)("There was a problem saving your store location","woocommerce-admin")):t(e)}getInitialValues(){const{settings:e}=this.props,{woocommerce_store_address:t,woocommerce_store_address_2:o,woocommerce_store_city:c,woocommerce_default_country:n,woocommerce_store_postcode:a}=e;return{addressLine1:t||"",addressLine2:o||"",city:c||"",countryState:n||"",postCode:a||""}}render(){const{isSettingsRequesting:e}=this.props;return e?null:Object(c.createElement)(d.Form,{initialValues:this.getInitialValues(),onSubmit:this.onSubmit,validate:J.b},({getInputProps:e,handleSubmit:t,setValue:o})=>Object(c.createElement)(c.Fragment,null,Object(c.createElement)(J.a,{getInputProps:e,setValue:o}),Object(c.createElement)(a.Button,{isPrimary:!0,onClick:t},Object(n.__)("Continue","woocommerce-admin"))))}}var Y=o(1),V=o.n(Y),Z=o(618),$=o(501);class Q extends c.Component{constructor(){super(...arguments),this.updateShippingZones=this.updateShippingZones.bind(this)}getShippingMethods(e,t=null){return e&&e.methods&&Array.isArray(e.methods)?t?e.methods?e.methods.filter(e=>e.method_id===t):[]:e.methods:[]}disableShippingMethods(e,t){t.length&&t.forEach(t=>{g()({method:"POST",path:`/wc/v3/shipping/zones/${e.id}/methods/${t.instance_id}`,data:{enabled:!1}})})}async updateShippingZones(e){const{clearTaskStatusCache:t,createNotice:o,shippingZones:c}=this.props;let a=!1,s=!1;c.forEach(t=>{0===t.id?a=t.toggleable&&e[t.id+"_enabled"]:s=""!==e[t.id+"_rate"]&&parseFloat(e[t.id+"_rate"])!==parseFloat(0);const o=this.getShippingMethods(t),c=parseFloat(e[t.id+"_rate"])===parseFloat(0)?"free_shipping":"flat_rate",n=this.getShippingMethods(t,c).length?this.getShippingMethods(t,c)[0]:null;if(!t.toggleable||e[t.id+"_enabled"]){if(n){const e=o.filter(e=>e.instance_id!==n.instance_id);this.disableShippingMethods(t,e)}g()({method:"POST",path:n?`/wc/v3/shipping/zones/${t.id}/methods/${n.instance_id}`:`/wc/v3/shipping/zones/${t.id}/methods`,data:{method_id:c,enabled:!0,settings:{cost:e[t.id+"_rate"]}}})}else this.disableShippingMethods(t,o)}),Object(l.recordEvent)("tasklist_shipping_set_costs",{shipping_cost:s,rest_world:a}),t(),o("success",Object(n.__)("Your shipping rates have been updated","woocommerce-admin")),this.props.onComplete()}renderInputPrefix(){const{symbolPosition:e,symbol:t}=this.context.getCurrencyConfig();return 0===e.indexOf("right")?null:Object(c.createElement)("span",{className:"woocommerce-shipping-rate__control-prefix"},t)}renderInputSuffix(e){const{symbolPosition:t,symbol:o}=this.context.getCurrencyConfig();return 0===t.indexOf("right")?Object(c.createElement)("span",{className:"woocommerce-shipping-rate__control-suffix"},o):parseFloat(e)===parseFloat(0)?Object(c.createElement)("span",{className:"woocommerce-shipping-rate__control-suffix"},Object(n.__)("Free shipping","woocommerce-admin")):null}getFormattedRate(e){const{formatDecimalString:t}=this.context,o=t(e);return e.length&&o.length?t(e):t(0)}getInitialValues(){const{formatDecimalString:e}=this.context,t={};return this.props.shippingZones.forEach(o=>{const c=this.getShippingMethods(o),n=c.length&&c[0].settings.cost?this.getFormattedRate(c[0].settings.cost.value):e(0);t[o.id+"_rate"]=n,c.length&&c[0].enabled?t[o.id+"_enabled"]=!0:t[o.id+"_enabled"]=!1}),t}validate(e){const t={};return Object.keys(e).filter(e=>e.endsWith("_rate")).forEach(o=>{e[o]<0&&(t[o]=Object(n.__)("Shipping rates can not be negative numbers.","woocommerce-admin"))}),t}render(){const{buttonText:e,shippingZones:t}=this.props;return t.length?Object(c.createElement)(d.Form,{initialValues:this.getInitialValues(),onSubmit:this.updateShippingZones,validate:this.validate},({getInputProps:o,handleSubmit:s,setTouched:i,setValue:r,values:m})=>Object(c.createElement)(c.Fragment,null,Object(c.createElement)("div",{className:"woocommerce-shipping-rates"},t.map(e=>Object(c.createElement)("div",{className:"woocommerce-shipping-rate",key:e.id},Object(c.createElement)("div",{className:"woocommerce-shipping-rate__icon"},e.locations?e.locations.map(e=>Object(c.createElement)(d.Flag,{size:24,code:e.code,key:e.code})):Object(c.createElement)(N.a,{icon:Z.a})),Object(c.createElement)("div",{className:"woocommerce-shipping-rate__main"},e.toggleable?Object(c.createElement)("label",{htmlFor:"woocommerce-shipping-rate__toggle-"+e.id,className:"woocommerce-shipping-rate__name"},e.name,Object(c.createElement)(a.FormToggle,D()({id:"woocommerce-shipping-rate__toggle-"+e.id},o(e.id+"_enabled")))):Object(c.createElement)("div",{className:"woocommerce-shipping-rate__name"},e.name),(!e.toggleable||m[e.id+"_enabled"])&&Object(c.createElement)(d.TextControlWithAffixes,D()({label:Object(n.__)("Shipping cost","woocommerce-admin"),required:!0},o(e.id+"_rate"),{onBlur:()=>{i(e.id+"_rate"),r(e.id+"_rate",this.getFormattedRate(m[e.id+"_rate"]))},prefix:this.renderInputPrefix(),suffix:this.renderInputSuffix(m[e.id+"_rate"]),className:"muriel-input-text woocommerce-shipping-rate__control-wrapper"})))))),Object(c.createElement)(a.Button,{isPrimary:!0,onClick:s},e||Object(n.__)("Update","woocommerce-admin")))):null}}Q.propTypes={buttonText:V.a.string,onComplete:V.a.func.isRequired,createNotice:V.a.func.isRequired,shippingZones:V.a.array},Q.defaultProps={shippingZones:[]},Q.contextType=$.a;var K=Object(O.compose)(Object(i.withDispatch)(e=>{const{invalidateResolutionForStoreSelector:t}=e(r.ONBOARDING_STORE_NAME);return{clearTaskStatusCache:()=>t("getTasksStatus")}}))(Q);class X extends c.Component{constructor(e){super(e),this.initialState={isPending:!1,step:"store_location",shippingZones:[]},this.activePlugins=e.activePlugins,this.state=this.initialState,this.completeStep=this.completeStep.bind(this)}componentDidMount(){this.reset()}reset(){this.setState(this.initialState)}async fetchShippingZones(){this.setState({isPending:!0});const{countryCode:e,countryName:t}=this.props,o=[],c=await g()({path:"/wc/v3/shipping/zones"});let a=!1;if(await Promise.all(c.map(async t=>{if(0===t.id)return t.methods=await g()({path:`/wc/v3/shipping/zones/${t.id}/methods`}),t.name=Object(n.__)("Rest of the world","woocommerce-admin"),t.toggleable=!0,void o.push(t);t.locations=await g()({path:`/wc/v3/shipping/zones/${t.id}/locations`});t.locations.find(t=>e===t.code)&&(t.methods=await g()({path:`/wc/v3/shipping/zones/${t.id}/methods`}),o.push(t),a=!0)})),!a){const c=await g()({method:"POST",path:"/wc/v3/shipping/zones",data:{name:t}});c.locations=await g()({method:"POST",path:`/wc/v3/shipping/zones/${c.id}/locations`,data:[{code:e,type:"country"}]}),o.push(c)}o.reverse(),this.setState({isPending:!1,shippingZones:o})}componentDidUpdate(e,t){const{countryCode:o,settings:c}=this.props,{woocommerce_store_address:n,woocommerce_default_country:a,woocommerce_store_postcode:s}=c,{step:i}=this.state;"rates"!==i||e.countryCode===o&&"rates"===t.step||this.fetchShippingZones();const r=Boolean(n&&a&&s);"store_location"===i&&r&&this.completeStep()}completeStep(){const{createNotice:e}=this.props,{step:t}=this.state,o=this.getSteps(),c=o.findIndex(e=>e.key===t),a=o[c+1];a?this.setState({step:a.key}):(e("success",Object(n.__)("ðŸ“¦ Shipping is done! Don't worry, you can always change it later","woocommerce-admin")),Object(_.getHistory)().push(Object(_.getNewPath)({},"/",{})))}getPluginsToActivate(){const{countryCode:e}=this.props,t=[];return["GB","CA","AU"].includes(e)?t.push("woocommerce-shipstation-integration"):"US"===e&&(t.push("woocommerce-services"),t.push("jetpack")),Object(h.difference)(t,this.activePlugins)}getSteps(){const{countryCode:e,isJetpackConnected:t,settings:o}=this.props,a=this.getPluginsToActivate(),s=!t&&"US"===e,i=[{key:"store_location",label:Object(n.__)("Set store location","woocommerce-admin"),description:Object(n.__)("The address from which your business operates","woocommerce-admin"),content:Object(c.createElement)(z,D()({},this.props,{onComplete:e=>{const t=Object(y.b)(e.countryState);Object(l.recordEvent)("tasklist_shipping_set_location",{country:t}),this.completeStep()}})),visible:!0},{key:"rates",label:Object(n.__)("Set shipping costs","woocommerce-admin"),description:Object(n.__)("Define how much customers pay to ship to different destinations","woocommerce-admin"),content:Object(c.createElement)(K,D()({buttonText:a.length||s?Object(n.__)("Proceed","woocommerce-admin"):Object(n.__)("Complete task","woocommerce-admin"),shippingZones:this.state.shippingZones,onComplete:this.completeStep},this.props)),visible:"disabled"!==o.woocommerce_ship_to_countries},{key:"label_printing",label:Object(n.__)("Enable shipping label printing","woocommerce-admin"),description:a.includes("woocommerce-shipstation-integration")?H()({mixedString:Object(n.__)("We recommend using ShipStation to save time at the post office by printing your shipping labels at home. Try ShipStation free for 30 days. {{link}}Learn more{{/link}}.","woocommerce-admin"),components:{link:Object(c.createElement)(d.Link,{href:"https://woocommerce.com/products/shipstation-integration?utm_medium=product",target:"_blank",type:"external"})}}):Object(n.__)("With WooCommerce Shipping you can save time by printing your USPS and DHL Express shipping labels at home","woocommerce-admin"),content:Object(c.createElement)(d.Plugins,D()({onComplete:(e,t)=>{Object(E.a)(t),Object(l.recordEvent)("tasklist_shipping_label_printing",{install:!0,plugins_to_activate:a}),this.completeStep()},onError:(e,t)=>Object(E.a)(t),onSkip:()=>{Object(l.recordEvent)("tasklist_shipping_label_printing",{install:!1,plugins_to_activate:a}),Object(_.getHistory)().push(Object(_.getNewPath)({},"/",{}))},pluginSlugs:a},this.props)),visible:a.length},{key:"connect",label:Object(n.__)("Connect your store","woocommerce-admin"),description:Object(n.__)("Connect your store to WordPress.com to enable label printing","woocommerce-admin"),content:Object(c.createElement)(W.a,D()({redirectUrl:Object(S.e)("admin.php?page=wc-admin"),completeStep:this.completeStep},this.props,{onConnect:()=>{Object(l.recordEvent)("tasklist_shipping_connect_store")}})),visible:s}];return Object(h.filter)(i,e=>e.visible)}render(){const{isPending:e,step:t}=this.state,{isUpdateSettingsRequesting:o}=this.props;return Object(c.createElement)("div",{className:"woocommerce-task-shipping"},Object(c.createElement)(a.Card,{className:"woocommerce-task-card"},Object(c.createElement)(a.CardBody,null,Object(c.createElement)(d.Stepper,{isPending:e||o,isVertical:!0,currentStep:t,steps:this.getSteps()}))))}}var ee=Object(O.compose)(Object(i.withSelect)(e=>{const{getSettings:t,isUpdateSettingsRequesting:o}=e(r.SETTINGS_STORE_NAME),{getActivePlugins:c,isJetpackConnected:n}=e(r.PLUGINS_STORE_NAME),{general:a={}}=t("general"),s=Object(y.b)(a.woocommerce_default_country),{countries:i=[]}=Object(S.f)("dataEndpoints",{}),m=s?i.find(e=>e.code===s):null,l=m?m.name:null,d=c();return{countryCode:s,countryName:l,isUpdateSettingsRequesting:o("general"),settings:a,activePlugins:d,isJetpackConnected:n()}}),Object(i.withDispatch)(e=>{const{createNotice:t}=e("core/notices"),{updateAndPersistSettingsForGroup:o}=e(r.SETTINGS_STORE_NAME);return{createNotice:t,updateAndPersistSettingsForGroup:o}}))(X);class te extends c.Component{constructor(e){super(e);const{hasCompleteAddress:t,pluginsToActivate:o}=e;this.initialState={isPending:!1,stepIndex:t?1:0,cachedPluginsToActivate:o},this.state=this.initialState,this.completeStep=this.completeStep.bind(this)}componentDidMount(){const{query:e}=this.props,{auto:t}=e;this.reset(),"true"===t&&this.enableAutomatedTax()}reset(){this.setState(this.initialState)}shouldShowSuccessScreen(){const{isJetpackConnected:e,hasCompleteAddress:t,pluginsToActivate:o}=this.props;return t&&!o.length&&e&&this.isTaxJarSupported()}isTaxJarSupported(){const{countryCode:e,tasksStatus:t}=this.props,{automatedTaxSupportedCountries:o=[],taxJarActivated:c}=t;return!c&&o.includes(e)}completeStep(){const{stepIndex:e}=this.state;this.getSteps()[e+1]&&this.setState({stepIndex:e+1})}async manuallyConfigureTaxRates(){const{generalSettings:e,updateAndPersistSettingsForGroup:t}=this.props;"yes"!==e.woocommerce_calc_taxes?(this.setState({isPending:!0}),t("general",{general:{...e,woocommerce_calc_taxes:"yes"}}).then(()=>this.redirectToTaxSettings()).catch(e=>Object(E.a)(e))):this.redirectToTaxSettings()}updateAutomatedTax(e){const{clearTaskStatusCache:t,createNotice:o,updateAndPersistSettingsForGroup:c,generalSettings:a,taxSettings:s}=this.props;Promise.all([c("tax",{tax:{...s,wc_connect_taxes_enabled:e?"yes":"no"}}),c("general",{general:{...a,woocommerce_calc_taxes:"yes"}})]).then(()=>{t(),e?(o("success",Object(n.__)("You're awesome! One less item on your to-do list âœ…","woocommerce-admin")),Object(_.getHistory)().push(Object(_.getNewPath)({},"/",{}))):this.redirectToTaxSettings()}).catch(()=>{o("error",Object(n.__)("There was a problem updating your tax settings","woocommerce-admin"))})}redirectToTaxSettings(){window.location=Object(S.e)("admin.php?page=wc-settings&tab=tax&section=standard&wc_onboarding_active_task=tax")}doNotChargeSalesTax(){const{updateOptions:e}=this.props;Object(l.queueRecordEvent)("tasklist_tax_connect_store",{connect:!1,no_tax:!0}),e({woocommerce_no_sales_tax:!0,woocommerce_calc_taxes:"no"}).then(()=>{window.location=Object(S.e)("admin.php?page=wc-admin")})}getSteps(){const{generalSettings:e,isJetpackConnected:t,isPending:o,tosAccepted:s,updateOptions:i}=this.props,{cachedPluginsToActivate:r}=this.state;let m,p;r.includes("woocommerce-services")?(m=Object(n.__)("Install Jetpack and WooCommerce Tax","woocommerce-admin"),p=Object(n.__)("By installing Jetpack and WooCommerce Tax you agree to the {{link}}Terms of Service{{/link}}.","woocommerce-admin")):(m=Object(n.__)("Install Jetpack","woocommerce-admin"),p=Object(n.__)("By installing Jetpack you agree to the {{link}}Terms of Service{{/link}}.","woocommerce-admin"));const u=[{key:"store_location",label:Object(n.__)("Set store location","woocommerce-admin"),description:Object(n.__)("The address from which your business operates","woocommerce-admin"),content:Object(c.createElement)(z,D()({},this.props,{onComplete:e=>{const t=Object(y.b)(e.countryState);Object(l.recordEvent)("tasklist_tax_set_location",{country:t}),this.completeStep()},isSettingsRequesting:!1,settings:e})),visible:!0},{key:"plugins",label:m,description:Object(n.__)("Jetpack and WooCommerce Tax allow you to automate sales tax calculations","woocommerce-admin"),content:Object(c.createElement)(c.Fragment,null,Object(c.createElement)(d.Plugins,{onComplete:(e,t)=>{Object(E.a)(t),Object(l.recordEvent)("tasklist_tax_install_extensions",{install_extensions:!0}),i({woocommerce_setup_jetpack_opted_in:!0}),this.completeStep()},onError:(e,t)=>Object(E.a)(t),onSkip:()=>{Object(l.queueRecordEvent)("tasklist_tax_install_extensions",{install_extensions:!1}),this.manuallyConfigureTaxRates()},skipText:Object(n.__)("Set up manually","woocommerce-admin"),onAbort:()=>this.doNotChargeSalesTax(),abortText:Object(n.__)("I don't charge sales tax","woocommerce-admin")}),!s&&Object(c.createElement)(k.Text,{variant:"caption",className:"woocommerce-task__caption",size:"12",lineHeight:"16px"},H()({mixedString:p,components:{link:Object(c.createElement)(d.Link,{href:"https://wordpress.com/tos/",target:"_blank",type:"external"})}}))),visible:(r.length||!s)&&this.isTaxJarSupported()},{key:"connect",label:Object(n.__)("Connect your store","woocommerce-admin"),description:Object(n.__)("Connect your store to WordPress.com to enable automated sales tax calculations","woocommerce-admin"),content:Object(c.createElement)(W.a,D()({},this.props,{onConnect:()=>{Object(l.recordEvent)("tasklist_tax_connect_store",{connect:!0,no_tax:!1})},onSkip:()=>{Object(l.queueRecordEvent)("tasklist_tax_connect_store",{connect:!1,no_tax:!1}),this.manuallyConfigureTaxRates()},skipText:Object(n.__)("Set up tax rates manually","woocommerce-admin"),onAbort:()=>this.doNotChargeSalesTax(),abortText:Object(n.__)("My business doesn't charge sales tax","woocommerce-admin")})),visible:!t&&this.isTaxJarSupported()},{key:"manual_configuration",label:Object(n.__)("Configure tax rates","woocommerce-admin"),description:Object(n.__)("Head over to the tax rate settings screen to configure your tax rates","woocommerce-admin"),content:Object(c.createElement)(c.Fragment,null,Object(c.createElement)(a.Button,{disabled:o,isPrimary:!0,isBusy:o,onClick:()=>{Object(l.recordEvent)("tasklist_tax_config_rates"),this.manuallyConfigureTaxRates()}},Object(n.__)("Configure","woocommerce-admin")),Object(c.createElement)("p",null,"yes"!==e.woocommerce_calc_taxes&&H()({mixedString:Object(n.__)('By clicking "Configure" you\'re enabling tax rates and calculations. More info {{link}}here{{/link}}.',"woocommerce-admin"),components:{link:Object(c.createElement)(d.Link,{href:"https://docs.woocommerce.com/document/setting-up-taxes-in-woocommerce/?utm_medium=product#section-1",target:"_blank",type:"external"})}}))),visible:!this.isTaxJarSupported()}];return Object(h.filter)(u,e=>e.visible)}enableAutomatedTax(){Object(l.recordEvent)("tasklist_tax_setup_automated_proceed",{setup_automatically:!0}),this.updateAutomatedTax(!0)}renderSuccessScreen(){const{isPending:e}=this.props;return Object(c.createElement)("div",{className:"woocommerce-task-tax__success"},Object(c.createElement)("span",{className:"woocommerce-task-tax__success-icon",role:"img","aria-labelledby":"woocommerce-task-tax__success-message"},"ðŸŽŠ"),Object(c.createElement)(d.H,{id:"woocommerce-task-tax__success-message"},Object(n.__)("Good news!","woocommerce-admin")),Object(c.createElement)("p",null,H()({mixedString:Object(n.__)("{{strong}}Jetpack{{/strong}} and {{strong}}WooCommerce Tax{{/strong}} can automate your sales tax calculations for you.","woocommerce-admin"),components:{strong:Object(c.createElement)("strong",null)}})),Object(c.createElement)(a.Button,{disabled:e,isPrimary:!0,isBusy:e,onClick:this.enableAutomatedTax.bind(this)},Object(n.__)("Yes please","woocommerce-admin")),Object(c.createElement)(a.Button,{disabled:e,isTertiary:!0,onClick:()=>{Object(l.recordEvent)("tasklist_tax_setup_automated_proceed",{setup_automatically:!1}),this.updateAutomatedTax(!1)}},Object(n.__)("No thanks, I'll set up manually","woocommerce-admin")),Object(c.createElement)(a.Button,{disabled:e,isTertiary:!0,onClick:()=>this.doNotChargeSalesTax()},Object(n.__)("I don't charge sales tax","woocommerce-admin")))}render(){const{stepIndex:e}=this.state,{isPending:t,isResolving:o}=this.props;if(o)return Object(c.createElement)(d.Spinner,null);const n=this.getSteps()[e];return Object(c.createElement)("div",{className:"woocommerce-task-tax"},Object(c.createElement)(a.Card,{className:"woocommerce-task-card"},Object(c.createElement)(a.CardBody,null,this.shouldShowSuccessScreen()?this.renderSuccessScreen():Object(c.createElement)(d.Stepper,{isPending:t||o,isVertical:!0,currentStep:n.key,steps:this.getSteps()}))))}}var oe=Object(O.compose)(Object(i.withSelect)(e=>{const{getSettings:t,isUpdateSettingsRequesting:o}=e(r.SETTINGS_STORE_NAME),{getOption:c,hasFinishedResolution:n}=e(r.OPTIONS_STORE_NAME),{getActivePlugins:a,isJetpackConnected:s,isPluginsRequesting:i}=e(r.PLUGINS_STORE_NAME),{getTasksStatus:m}=e(r.ONBOARDING_STORE_NAME),{general:l={}}=t("general"),d=Object(y.b)(l.woocommerce_default_country),{woocommerce_store_address:p,woocommerce_default_country:u,woocommerce_store_postcode:_}=l,b=Boolean(p&&u&&_),{tax:g={}}=t("tax"),O=a(),j=Object(h.difference)(["jetpack","woocommerce-services"],O),w=c("wc_connect_options")||{},k=c("woocommerce_setup_jetpack_opted_in"),E=w.tos_accepted||"1"===k,S=m(),f=o("tax")||o("general"),v=i("getJetpackConnectUrl")||!n("getOption",["woocommerce_setup_jetpack_opted_in"])||!n("getOption",["wc_connect_options"])||void 0===k||void 0===w;return{countryCode:d,generalSettings:l,hasCompleteAddress:b,isJetpackConnected:s(),isPending:f,isResolving:v,pluginsToActivate:j,tasksStatus:S,taxSettings:g,tosAccepted:E}}),Object(i.withDispatch)(e=>{const{createNotice:t}=e("core/notices"),{updateOptions:o}=e(r.OPTIONS_STORE_NAME),{updateAndPersistSettingsForGroup:c}=e(r.SETTINGS_STORE_NAME),{invalidateResolutionForStoreSelector:n}=e(r.ONBOARDING_STORE_NAME);return{clearTaskStatusCache:()=>n("getTasksStatus"),createNotice:t,updateAndPersistSettingsForGroup:c,updateOptions:o}}))(te),ce=o(6),ne=o.n(ce),ae=o(271),se=o(522);o(542);const ie=({isRecommended:e,markConfigured:t,paymentGateway:o})=>{var n,s;const{image:i,content:r,id:m,plugins:d=[],title:p,loading:u,enabled:_=!1,installed:b=!1,needsSetup:g=!0,requiredSettings:O,settingsUrl:h,is_local_partner:j}=o,w=Object(k.useSlot)("woocommerce_payment_gateway_configure_"+m),y=Object(k.useSlot)("woocommerce_payment_gateway_setup_"+m),E=Boolean(null==w||null===(n=w.fills)||void 0===n?void 0:n.length)||Boolean(null==y||null===(s=y.fills)||void 0===s?void 0:s.length),S=Boolean(d.length||O.length||E),f=e&&g,v=ne()("woocommerce-task-payment","woocommerce-task-card",g&&"woocommerce-task-payment-not-configured","woocommerce-task-payment-"+m);return Object(c.createElement)(c.Fragment,{key:m},Object(c.createElement)(a.CardBody,{style:{paddingLeft:0,marginBottom:0},className:v},Object(c.createElement)(a.CardMedia,{isBorderless:!0},Object(c.createElement)("img",{src:i,alt:p})),Object(c.createElement)("div",{className:"woocommerce-task-payment__description"},f&&Object(c.createElement)(ae.RecommendedRibbon,{isLocalPartner:j}),Object(c.createElement)(k.Text,{as:"h3",className:"woocommerce-task-payment__title"},p,b&&g&&!!d.length&&Object(c.createElement)(ae.SetupRequired,null)),Object(c.createElement)("div",{className:"woocommerce-task-payment__content"},r)),Object(c.createElement)("div",{className:"woocommerce-task-payment__footer"},Object(c.createElement)(se.a,{manageUrl:h,id:m,hasSetup:S,needsSetup:g,isEnabled:_,isInstalled:b,hasPlugins:Boolean(d.length),isRecommended:e,isLoading:u,markConfigured:t,onSetUp:()=>Object(l.recordEvent)("tasklist_payment_setup",{selected:m})}))),Object(c.createElement)(a.CardDivider,null))},re=({heading:e,markConfigured:t,recommendation:o,paymentGateways:n})=>Object(c.createElement)(a.Card,null,Object(c.createElement)(a.CardHeader,{as:"h2"},e),n.map(e=>{const{id:n}=e;return Object(c.createElement)(ie,{key:n,isRecommended:o===n,markConfigured:t,paymentGateway:e})})),me=()=>{const e=ne()("woocommerce-task-payment","woocommerce-task-card");return Object(c.createElement)(c.Fragment,null,Object(c.createElement)(a.CardBody,{style:{paddingLeft:0,marginBottom:0},className:e},Object(c.createElement)(a.CardMedia,{isBorderless:!0},Object(c.createElement)("span",{className:"is-placeholder"})),Object(c.createElement)("div",{className:"woocommerce-task-payment__description"},Object(c.createElement)(k.Text,{as:"h3",className:"woocommerce-task-payment__title"},Object(c.createElement)("span",{className:"is-placeholder"})),Object(c.createElement)("div",{className:"woocommerce-task-payment__content"},Object(c.createElement)("span",{className:"is-placeholder"}))),Object(c.createElement)("div",{className:"woocommerce-task-payment__footer"},Object(c.createElement)("span",{className:"is-placeholder"}))),Object(c.createElement)(a.CardDivider,null))},le=()=>Object(c.createElement)(a.Card,{"aria-hidden":"true",className:"is-loading woocommerce-payment-gateway-suggestions-list-placeholder"},Object(c.createElement)(a.CardHeader,{as:"h2"},Object(c.createElement)("span",{className:"is-placeholder"})),Object(c.createElement)(me,null),Object(c.createElement)(me,null),Object(c.createElement)(me,null));var de=o(508);const pe=({markConfigured:e,paymentGateway:t})=>{var o;const{id:s,connectionUrl:m,setupHelpText:p,settingsUrl:u,title:_,requiredSettings:b}=t,{createNotice:g}=Object(i.useDispatch)("core/notices"),{updatePaymentGateway:O}=Object(i.useDispatch)(r.PAYMENT_GATEWAYS_STORE_NAME),h=Object(k.useSlot)("woocommerce_payment_gateway_configure_"+s),j=Boolean(null==h||null===(o=h.fills)||void 0===o?void 0:o.length),{isUpdating:w}=Object(i.useSelect)(e=>{const{isPaymentGatewayUpdating:t}=e(r.PAYMENT_GATEWAYS_STORE_NAME);return{isUpdating:t()}}),y=t=>{O(s,{enabled:!0,settings:t}).then(t=>{t&&t.id===s&&(e(s),g("success",Object(n.sprintf)(Object(n.__)("%s configured successfully","woocommerce-admin"),_)))}).catch(()=>{g("error",Object(n.__)("There was a problem saving your payment settings","woocommerce-admin"))})},E=p&&Object(c.createElement)("p",{dangerouslySetInnerHTML:Object(de.a)(p)}),S=Object(c.createElement)(d.DynamicForm,{fields:b,isBusy:w,onSubmit:y,submitLabel:Object(n.__)("Proceed","woocommerce-admin"),validate:e=>((e,t)=>{const o={},c=e=>t.find(t=>t.id===e);for(const[t,n]of Object.entries(e)){const e=c(t),a=e.label.replace(/([A-Z][a-z]+)/g,e=>e.toLowerCase());n||"checkbox"===e.type||(o[t]="Please enter your "+a)}return o})(e,b)});return j?Object(c.createElement)(ae.WooPaymentGatewayConfigure.Slot,{fillProps:{defaultForm:S,defaultSubmit:y,defaultFields:b,markConfigured:()=>e(s),paymentGateway:t},id:s}):m?Object(c.createElement)(c.Fragment,null,E,Object(c.createElement)(a.Button,{isPrimary:!0,onClick:()=>Object(l.recordEvent)("tasklist_payment_connect_start",{payment_method:s}),href:m},Object(n.__)("Connect","woocommerce-admin"))):b.length?Object(c.createElement)(c.Fragment,null,E,S):Object(c.createElement)(c.Fragment,null,E||Object(c.createElement)("p",null,Object(n.__)("You can manage this payment gateway's settings by clicking the button below","woocommerce-admin")),Object(c.createElement)(a.Button,{isPrimary:!0,href:u},Object(n.__)("Set up","woocommerce-admin")))};o(607);const ue=({markConfigured:e,paymentGateway:t})=>{var o;const{id:s,plugins:m=[],title:p,postInstallScripts:u,installed:_}=t,b=Object(k.useSlot)("woocommerce_payment_gateway_setup_"+s),g=Boolean(null==b||null===(o=b.fills)||void 0===o?void 0:o.length),[O,h]=Object(c.useState)(!1);Object(c.useEffect)(()=>{Object(l.recordEvent)("payments_task_stepper_view",{payment_method:s})},[]);const{invalidateResolutionForStoreSelector:j}=Object(i.useDispatch)(r.PAYMENT_GATEWAYS_STORE_NAME),{isOptionUpdating:w,isPaymentGatewayResolving:y,needsPluginInstall:f}=Object(i.useSelect)(e=>{const{isOptionsUpdating:t}=e(r.OPTIONS_STORE_NAME),{isResolving:o}=e(r.PAYMENT_GATEWAYS_STORE_NAME),c=e(r.PLUGINS_STORE_NAME).getActivePlugins(),n=m.filter(e=>!c.includes(e));return{isOptionUpdating:t(),isPaymentGatewayResolving:o("getPaymentGateways"),needsPluginInstall:!!n.length}});Object(c.useEffect)(()=>{if(!f)if(u&&u.length){const e=u.map(e=>Object(S.d)(e));Promise.all(e).then(()=>{h(!0)})}else h(!0)},[u,f]);const v=Object(c.useMemo)(()=>m&&m.length?{key:"install",label:Object(n.sprintf)(Object(n.__)("Install %s","woocommerce-admin"),p),content:Object(c.createElement)(d.Plugins,{onComplete:(e,t)=>{Object(E.a)(t),j("getPaymentGateways"),Object(l.recordEvent)("tasklist_payment_install_method",{plugins:m})},onError:(e,t)=>Object(E.a)(t),autoInstall:!0,pluginSlugs:m})}:null,[]),C=Object(c.useMemo)(()=>({key:"configure",label:Object(n.sprintf)(Object(n.__)("Configure your %(title)s account","woocommerce-admin"),{title:p}),content:_?Object(c.createElement)(pe,{markConfigured:e,paymentGateway:t}):null}),[_]),T=f||w||y||!O,x=Object(c.createElement)(d.Stepper,{isVertical:!0,isPending:T,currentStep:f?"install":"configure",steps:[v,C].filter(Boolean)});return Object(c.createElement)(a.Card,{className:"woocommerce-task-payment-method woocommerce-task-card"},Object(c.createElement)(a.CardBody,null,g?Object(c.createElement)(ae.WooPaymentGatewaySetup.Slot,{fillProps:{defaultStepper:x,defaultInstallStep:v,defaultConfigureStep:C,markConfigured:()=>e(s),paymentGateway:t},id:s}):x))},_e=()=>{const e=ne()("is-loading","woocommerce-task-payment-method","woocommerce-task-card");return Object(c.createElement)(a.Card,{"aria-hidden":"true",className:e},Object(c.createElement)(a.CardBody,null,Object(c.createElement)(d.Stepper,{isVertical:!0,currentStep:"none",steps:[{key:"first",label:""},{key:"second",label:""}]})))};var be=o(523),ge=o(76);const Oe={account_name:"",account_number:"",bank_name:"",sort_code:"",iban:"",bic:""};Object(ge.registerPlugin)("wc-admin-payment-gateway-setup-bacs",{render:()=>{const e=Object(i.useSelect)(e=>e(r.OPTIONS_STORE_NAME).isOptionsUpdating()),{createNotice:t}=Object(i.useDispatch)("core/notices"),{updateOptions:o}=Object(i.useDispatch)(r.OPTIONS_STORE_NAME),s=e=>{const t={};return e.account_number||e.iban||(t.account_number=t.iban=Object(n.__)("Please enter an account number or IBAN","woocommerce-admin")),t};return Object(c.createElement)(c.Fragment,null,Object(c.createElement)(ae.WooPaymentGatewaySetup,{id:"bacs"},({markConfigured:i})=>Object(c.createElement)(d.Form,{initialValues:Oe,onSubmit:e=>(async(e,c)=>{if((await o({woocommerce_bacs_settings:{enabled:"yes"},woocommerce_bacs_accounts:[e]})).success)return c(),void t("success",Object(n.__)("Direct bank transfer details added successfully","woocommerce-admin"));t("error",Object(n.__)("There was a problem saving your payment settings","woocommerce-admin"))})(e,i),validate:s},({getInputProps:t,handleSubmit:o})=>Object(c.createElement)(c.Fragment,null,Object(c.createElement)(d.H,null,Object(n.__)("Add your bank details","woocommerce-admin")),Object(c.createElement)("p",null,Object(n.__)("These details are required to receive payments via bank transfer","woocommerce-admin")),Object(c.createElement)("div",{className:"woocommerce-task-payment-method__fields"},Object(c.createElement)(d.TextControl,D()({label:Object(n.__)("Account name","woocommerce-admin"),required:!0},t("account_name"))),Object(c.createElement)(d.TextControl,D()({label:Object(n.__)("Account number","woocommerce-admin"),required:!0},t("account_number"))),Object(c.createElement)(d.TextControl,D()({label:Object(n.__)("Bank name","woocommerce-admin"),required:!0},t("bank_name"))),Object(c.createElement)(d.TextControl,D()({label:Object(n.__)("Sort code","woocommerce-admin"),required:!0},t("sort_code"))),Object(c.createElement)(d.TextControl,D()({label:Object(n.__)("IBAN","woocommerce-admin"),required:!0},t("iban"))),Object(c.createElement)(d.TextControl,D()({label:Object(n.__)("BIC / Swift","woocommerce-admin"),required:!0},t("bic")))),Object(c.createElement)(a.Button,{isPrimary:!0,isBusy:e,onClick:o},Object(n.__)("Save","woocommerce-admin"))))))},scope:"woocommerce-admin"});const he=({query:e})=>{const{invalidateResolutionForStoreSelector:t}=Object(i.useDispatch)(r.ONBOARDING_STORE_NAME),{updatePaymentGateway:o}=Object(i.useDispatch)(r.PAYMENT_GATEWAYS_STORE_NAME),{getPaymentGateway:a,paymentGatewaySuggestions:s,installedPaymentGateways:m,isResolving:d}=Object(i.useSelect)(e=>({getPaymentGateway:e(r.PAYMENT_GATEWAYS_STORE_NAME).getPaymentGateway,getOption:e(r.OPTIONS_STORE_NAME).getOption,installedPaymentGateways:e(r.PAYMENT_GATEWAYS_STORE_NAME).getPaymentGateways(),isResolving:e(r.ONBOARDING_STORE_NAME).isResolving("getPaymentGatewaySuggestions"),paymentGatewaySuggestions:e(r.ONBOARDING_STORE_NAME).getPaymentGatewaySuggestions()}),[]),p=Object(c.useMemo)(()=>{const e=m.reduce((e,t)=>(e[t.id]=t,e),{});return s.reduce((t,o)=>{const{id:c}=o,n=e[o.id]?e[c]:{},a={installed:!!e[c],postInstallScripts:n.post_install_scripts,enabled:n.enabled||!1,needsSetup:n.needs_setup,settingsUrl:n.settings_url,connectionUrl:n.connection_url,setupHelpText:n.setup_help_text,title:n.title,requiredSettings:n.required_settings_keys?n.required_settings_keys.map(e=>n.settings[e]).filter(Boolean):[],...o};return t.set(c,a),t},new Map)},[m,s]);Object(c.useEffect)(()=>{p.size&&Object(l.recordEvent)("tasklist_payments_options",{options:Array.from(p.values()).map(e=>e.id)})},[p]);const u=Object(c.useCallback)(async(e,c={})=>{if(!p.get(e))throw`Payment gateway ${e} not found in available gateways list`;(e=>{if(!e)return;const c=a(e);c&&!c.enabled&&o(e,{enabled:!0}).then(()=>{t("getTasksStatus")})})(e),Object(l.recordEvent)("tasklist_payment_connect_method",{payment_method:e}),Object(_.getHistory)().push(Object(_.getNewPath)({...c},"/",{}))},[p]),b=Object(c.useMemo)(()=>Array.from(p.values()).filter(e=>e.recommendation_priority).sort((e,t)=>e.recommendation_priority-t.recommendation_priority).map(e=>e.id).shift(),[p]),g=Object(c.useMemo)(()=>{if(!e.id||d||!p.size)return null;const t=p.get(e.id);if(!t)throw`Current gateway ${e.id} not found in available gateways list`;return t},[d,e,p]),[O,h,j]=Object(c.useMemo)(()=>Array.from(p.values()).reduce((e,t)=>{const[o,c,n]=e;return"woocommerce_payments"!==t.id||t.installed&&!t.needsSetup?t.enabled?c.push(t):n.push(t):o.push(t),e},[[],[],[]]),[p]);return e.id&&!g?Object(c.createElement)(_e,null):g?Object(c.createElement)(ue,{paymentGateway:g,markConfigured:u}):Object(c.createElement)("div",{className:"woocommerce-task-payments"},!p.size&&Object(c.createElement)(le,null),!!O.length&&Object(c.createElement)(be.a,{paymentGateway:O[0]}),!!h.length&&Object(c.createElement)(re,{heading:Object(n.__)("Enabled payment gateways","woocommerce-admin"),recommendation:b,paymentGateways:h}),!!j.length&&Object(c.createElement)(re,{heading:Object(n.__)("Additional payment gateways","woocommerce-admin"),recommendation:b,paymentGateways:j,markConfigured:u}))};var je=o(531),we=o(547);function ye(e,t,o,c){Object(l.recordEvent)("task_view",{task_name:e,wcs_installed:c.includes("woocommerce-services"),wcs_active:o.includes("woocommerce-services"),jetpack_installed:c.includes("jetpack"),jetpack_active:o.includes("jetpack"),jetpack_connected:t})}function ke(e,t){if(e.completed||t.completed)return e.completed?1:-1;const o=e.level||3,c=t.level||3;return o===c?0:o>c?1:-1}o(608);function Ee(e,t,o){return[...new Set([...e,...t])].filter(e=>!o.includes(e))}var Se=({query:e,name:t,eventName:o,isComplete:s,dismissedTasks:m,remindMeLaterTasks:p,tasks:u,trackedCompletedTasks:b,title:g,collapsible:O=!1,onComplete:h,onHide:j,expandingItems:w=!1})=>{const{createNotice:y}=Object(i.useDispatch)("core/notices"),{updateOptions:E}=Object(i.useDispatch)(r.OPTIONS_STORE_NAME),{profileItems:S}=Object(i.useSelect)(e=>{const{getProfileItems:t}=e(r.ONBOARDING_STORE_NAME);return{profileItems:t()}}),f=Object(c.useRef)(e);Object(c.useEffect)(()=>{R()},[]),Object(c.useEffect)(()=>{const{task:t}=f.current,{task:o}=e;t!==o&&(window.document.documentElement.scrollTop=0,f.current=e),N(),P()},[e]);const v=Date.now(),C=u.filter(e=>e.visible&&!m.includes(e.key)&&(!p[e.key]||p[e.key]<v)),T=C.filter(e=>e.completed).map(e=>e.key),x=u.filter(e=>e.visible&&!e.completed&&!m.includes(e.key)),N=()=>{const e=`woocommerce_${t}_complete`,o=s?{[e]:"no"}:{[e]:"yes"};(!x.length&&!s||x.length&&s)&&(E({...o}),"function"==typeof h&&h())},P=()=>{const e=function(e,t){if(!t)return[];return e.filter(e=>t.includes(e))}(T,b),t=(o=e,c=b,C.filter(e=>c.includes(e.key)&&!o.includes(e.key)).map(e=>e.key));var o,c;(function(e,t,o){if(t.length>0)return!0;if(0===o.length)return!1;return!o.every(t=>e.indexOf(t)>=0)})(e,t,T)&&E({woocommerce_task_list_tracked_completed_tasks:Ee(T,b,t)})},A=e=>{const t=m.filter(t=>t!==e);E({woocommerce_task_list_dismissed_tasks:t}),Object(l.recordEvent)(o+"_undo_dismiss_task",{task_name:e})},I=e=>{const{[e]:t,...c}=p;E({woocommerce_task_list_remind_me_later_tasks:c}),Object(l.recordEvent)(o+"_undo_remindmelater_task",{task_name:e})},R=()=>{e.task||Object(l.recordEvent)(o+"_view",{number_tasks:C.length,store_connected:S.wccom_connected})},M=C.map(e=>(e.onClick||(e.onClick=t=>{if(Object(l.recordEvent)(o+"_click",{task_name:e.key}),"A"===t.target.nodeName)return!1;Object(_.updateQueryString)({task:e.key})}),e));if(!M.length)return Object(c.createElement)("div",{className:"woocommerce-task-dashboard__container"});const B=Object(n.sprintf)(Object(n._n)("Show %i more task.","Show %i more tasks.",M.length-2,"woocommerce-admin"),M.length-2),G=Object(n.__)("Show less","woocommerce-admin"),F=O?k.CollapsibleList:k.List,L=O?{collapseLabel:G,expandLabel:B,show:2,onCollapse:()=>Object(l.recordEvent)(o+"_collapse"),onExpand:()=>Object(l.recordEvent)(o+"_expand")}:{};return Object(c.createElement)(c.Fragment,null,Object(c.createElement)("div",{className:"woocommerce-task-dashboard__container"},Object(c.createElement)(a.Card,{size:"large",className:"woocommerce-task-card woocommerce-homescreen-card"},Object(c.createElement)(a.CardHeader,{size:"medium"},Object(c.createElement)("div",{className:"wooocommerce-task-card__header"},Object(c.createElement)(k.Text,{size:"20",lineHeight:"28px",variant:"title.small"},g),Object(c.createElement)(d.Badge,{count:x.length})),Object(c.createElement)("div",{className:"woocommerce-card__menu woocommerce-card__header-item"},Object(c.createElement)(d.EllipsisMenu,{label:Object(n.__)("Task List Options","woocommerce-admin"),renderContent:()=>Object(c.createElement)("div",{className:"woocommerce-task-card__section-controls"},Object(c.createElement)(a.Button,{onClick:()=>(e=>{const c={[`woocommerce_${t}_hidden`]:"yes"};Object(l.recordEvent)(o+"_completed",{action:e,completed_task_count:T.length,incomplete_task_count:x.length}),E({...c}),"function"==typeof j&&j()})("remove_card")},Object(n.__)("Hide this","woocommerce-admin")))}))),Object(c.createElement)(F,D()({animation:"custom"},L),M.map(e=>Object(c.createElement)(k.TaskItem,{key:e.key,title:e.title,completed:e.completed,content:e.content,expandable:w&&e.expandable,expanded:w&&e.expanded,onClick:e.onClick,onDismiss:e.isDismissable?()=>(({key:e,onDismiss:t})=>{y("success",Object(n.__)("Task dismissed"),{actions:[{label:Object(n.__)("Undo","woocommerce-admin"),onClick:()=>A(e)}]}),Object(l.recordEvent)(o+"_dismiss_task",{task_name:e}),E({woocommerce_task_list_dismissed_tasks:[...m,e]}),t&&t()})(e):void 0,remindMeLater:e.allowRemindMeLater?()=>(({key:e,onDismiss:t})=>{y("success",Object(n.__)("Task postponed until tomorrow","woocommerce-admin"),{actions:[{label:Object(n.__)("Undo","woocommerce-admin"),onClick:()=>I(e)}]}),Object(l.recordEvent)(o+"_remindmelater_task",{task_name:e});const c=Date.now()+864e5;E({woocommerce_task_list_remind_me_later_tasks:{...p,[e]:c}}),t&&t()})(e):void 0,time:e.time,level:e.level,action:e.action,actionLabel:e.actionLabel,additionalInfo:e.additionalInfo,showActionButton:e.showActionButton,onExpand:e.onExpand,onCollapse:e.onCollapse}))))))},fe=o(170);const ve=({taskContainer:e,query:t})=>{const o=Object(c.useRef)(),{isJetpackConnected:n,activePlugins:a,installedPlugins:s}=Object(i.useSelect)(e=>{const{getActivePlugins:t,getInstalledPlugins:o,isJetpackConnected:c}=e(r.PLUGINS_STORE_NAME);return{activePlugins:t(),isJetpackConnected:c(),installedPlugins:o()}});return Object(c.useEffect)(()=>{const{task:e}=t;o.current!==e&&(window.document.documentElement.scrollTop=0),o.current=e,(()=>{const{task:e}=t;e&&ye(e,n,a,s)})()},[t]),e&&t.task?Object(c.createElement)("div",{className:"woocommerce-task-dashboard__container"},Object(c.cloneElement)(e,{query:t})):null};var Ce=o(543);const Te=[],xe=e=>{const{getFreeExtensions:t,getProfileItems:o,getTasksStatus:c}=e(r.ONBOARDING_STORE_NAME),{getSettings:n}=e(r.SETTINGS_STORE_NAME),{getOption:a,hasFinishedResolution:s}=e(r.OPTIONS_STORE_NAME),{getActivePlugins:i,getInstalledPlugins:m,isJetpackConnected:l}=e(r.PLUGINS_STORE_NAME),d=o(),p=a("woocommerce_task_list_tracked_completed_tasks")||Te,u=a("woocommerce_task_list_tracked_completed_actions")||Te,{general:_={}}=n("general"),b=Object(y.b)(_.woocommerce_default_country),{woocommerce_store_address:g,woocommerce_default_country:O,woocommerce_store_postcode:h}=_,j=Boolean(g&&O&&h),w=i(),k=m(),E=c();return{activePlugins:w,countryCode:b,dismissedTasks:a("woocommerce_task_list_dismissed_tasks"),freeExtensions:t(),remindMeLaterTasks:a("woocommerce_task_list_remind_me_later_tasks"),isExtendedTaskListComplete:"yes"===a("woocommerce_extended_task_list_complete"),isExtendedTaskListHidden:"yes"===a("woocommerce_extended_task_list_hidden"),isJetpackConnected:l(),isSetupTaskListHidden:"yes"===a("woocommerce_task_list_hidden"),isTaskListComplete:"yes"===a("woocommerce_task_list_complete"),installedPlugins:k,trackedCompletedActions:u,onboardingStatus:E,profileItems:d,trackedCompletedTasks:p,hasCompleteAddress:j,isResolving:!(s("getOption",["woocommerce_task_list_complete"])&&s("getOption",["woocommerce_task_list_hidden"])&&s("getOption",["woocommerce_extended_task_list_complete"])&&s("getOption",["woocommerce_extended_task_list_hidden"])&&s("getOption",["woocommerce_task_list_remind_me_later_tasks"])&&s("getOption",["woocommerce_task_list_tracked_completed_tasks"])&&s("getOption",["woocommerce_task_list_dismissed_tasks"]))}};t.default=({userPreferences:e,query:t})=>{const{createNotice:o}=Object(i.useDispatch)("core/notices"),{updateOptions:b}=Object(i.useDispatch)(r.OPTIONS_STORE_NAME),{installAndActivatePlugins:g}=Object(i.useDispatch)(r.PLUGINS_STORE_NAME),{trackedCompletedTasks:O,activePlugins:h,countryCode:j,freeExtensions:k,installedPlugins:E,isJetpackConnected:S,onboardingStatus:f,profileItems:v,isSetupTaskListHidden:C,dismissedTasks:N,remindMeLaterTasks:P,isTaskListComplete:A,isExtendedTaskListHidden:I,isExtendedTaskListComplete:R,hasCompleteAddress:M,trackedCompletedActions:B,isResolving:G}=Object(i.useSelect)(xe),[F,U]=Object(c.useState)(!1),[D,q]=Object(m.useExperiment)("woocommerce_tasklist_progression");Object(c.useEffect)(()=>{document.body.classList.add("woocommerce-onboarding"),document.body.classList.add("woocommerce-task-dashboard__body")},[]);const H=()=>{F||Object(l.recordEvent)("tasklist_purchase_extensions"),U(!F)},W=e=>Object(c.createElement)(Se,{name:"extended_task_list",eventName:"extended_tasklist",collapsible:!0,dismissedTasks:N||[],remindMeLaterTasks:P||[],isComplete:R,query:t,tasks:e,title:Object(n.__)("Things to do next","woocommerce-admin"),trackedCompletedTasks:O||[]}),J=function({activePlugins:e,countryCode:t,createNotice:o,freeExtensions:a,installAndActivatePlugins:s,installedPlugins:i,isJetpackConnected:r,onboardingStatus:m,profileItems:l,query:d,toggleCartModal:p,onTaskSelect:b,hasCompleteAddress:g,trackedCompletedActions:O}){const{hasPaymentGateway:h,hasPhysicalProducts:j,hasProducts:k,isAppearanceComplete:E,isTaxComplete:S,shippingZonesCount:f,wcPayIsConnected:v}={hasPaymentGateway:!1,hasPhysicalProducts:!1,hasProducts:!1,isAppearanceComplete:!1,isTaxComplete:!1,shippingZonesCount:0,wcPayIsConnected:!1,...m},C=Object(y.a)(l,i),{products:N,remainingProducts:P,uniqueItemsList:A}=C,I=-1!==i.indexOf("woocommerce-payments"),R=-1!==e.indexOf("woocommerce-services"),{completed:M,product_types:B,business_extensions:G}=l,F=(G||[]).includes("woocommerce-payments");let U,D=Object(n.__)("Add paid extensions to my store","woocommerce-admin");if(1===A.length){var q;const{name:e}=A[0],t=Object(n.__)("Add %s to my store","woocommerce-admin");D=Object(n.sprintf)(t,e),U=null===(q=N.find(({label:t})=>t===e))||void 0===q?void 0:q.description}else{const e=A.map(({name:e})=>e),t=e.pop();let o=e.join(", ");e.length>1&&(o+=","),U=Object(n.sprintf)(Object(n.__)("Good choice! You chose to add %1$s and %2$s to your store.","woocommerce-admin"),o,t)}const{automatedTaxSupportedCountries:H=[],taxJarActivated:W}=m,J=!W&&H.includes(t),z=g&&R&&J;let Y=Object(n.__)("Let's go","woocommerce-admin"),V=Object(n.__)("Set your store location and configure tax rate settings.","woocommerce-admin");z&&(Y=Object(n.__)("Yes please","woocommerce-admin"),V=Object(n.__)("Good news! WooCommerce Services and Jetpack can automate your sales tax calculations for you.","woocommerce-admin"));const[Z,$]=T(a,e,i),Q=[{key:"store_details",title:Object(n.__)("Store details","woocommerce-admin"),content:Object(n.__)("Your store address is required to set the origin country for shipping, currencies, and payment options.","woocommerce-admin"),container:null,action:Object(n.__)("Let's go","woocommerce-admin"),onClick:()=>{b("store_details"),Object(_.getHistory)().push(Object(_.getNewPath)({},"/setup-wizard",{}))},completed:M,visible:!0,time:Object(n.__)("4 minutes","woocommerce-admin"),type:"setup"},{key:"purchase",title:D,content:U,container:null,action:Object(n.__)("Purchase & install now","woocommerce-admin"),onClick:()=>(b("purchase"),P.length?p():null),visible:N.length,completed:N.length&&!P.length,time:Object(n.__)("2 minutes","woocommerce-admin"),isDismissable:!0,type:"setup"},{key:"products",title:Object(n.__)("Add my products","woocommerce-admin"),content:Object(n.__)("Start by adding the first product to your store. You can add your products manually, via CSV, or import them from another service.","woocommerce-admin"),container:Object(c.createElement)(L,null),onClick:()=>{b("products"),Object(_.updateQueryString)({task:"products"})},completed:k,visible:!0,time:Object(n.__)("1 minute per product","woocommerce-admin"),type:"setup"},{key:"woocommerce-payments",title:Object(n.__)("Get paid with WooCommerce Payments","woocommerce-admin"),content:Object(n.__)("You're only one step away from getting paid. Verify your business details to start managing transactions with WooCommerce Payments.","woocommerce-admin"),action:Object(n.__)("Finish setup","woocommmerce-admin"),expanded:!0,container:Object(c.createElement)(c.Fragment,null),completed:v,onClick:async t=>{if("A"===t.target.nodeName)return!1;await new Promise((t,c)=>(ye("wcpay",r,e,i),b("woocommerce-payments"),Object(be.b)(c,o,s)))},visible:F&&I&&Object(be.c)(t),additionalInfo:Object(n.__)('By setting up, you are agreeing to the <a href="https://wordpress.com/tos/" target="_blank">Terms of Service</a>',"woocommerce-admin"),time:Object(n.__)("2 minutes","woocommerce-admin"),type:"setup"},{key:"payments",title:Object(n.__)("Set up payments","woocommerce-admin"),content:Object(n.__)("Choose payment providers and enable payment methods at checkout.","woocommerce-admin"),container:Object(c.createElement)(he,{query:d}),completed:h,onClick:()=>{b("payments"),Object(_.updateQueryString)({task:"payments"})},visible:window.wcAdminFeatures["payment-gateway-suggestions"]&&(!I||!F||!Object(be.c)(t)),time:Object(n.__)("2 minutes","woocommerce-admin"),type:"setup"},{key:"tax",title:Object(n.__)("Set up tax","woocommerce-admin"),content:V,container:Object(c.createElement)(oe,null),action:Y,onClick:(e,t={})=>{const{isExpanded:o}=t;b("tax"),Object(_.updateQueryString)({task:"tax",auto:z&&o})},completed:S,visible:!0,time:Object(n.__)("1 minute","woocommerce-admin"),type:"setup"},{key:"shipping",title:Object(n.__)("Set up shipping","woocommerce-admin"),content:Object(n.__)("Set your store location and where you'll ship to.","woocommerce-admin"),container:Object(c.createElement)(ee,null),action:Object(n.__)("Let's go","woocommerce-admin"),onClick:()=>{f>0?window.location=Object(we.b)({type:"wc-settings",tab:"shipping"}).href:(b("shipping"),Object(_.updateQueryString)({task:"shipping"}))},completed:f>0,visible:B&&B.includes("physical")||j,time:Object(n.__)("1 minute","woocommerce-admin"),type:"setup"},{key:"marketing",title:Object(n.__)("Set up marketing tools","woocommerce-admin"),content:Object(n.__)("Add recommended marketing tools to reach new customers and grow your business","woocommerce-admin"),container:Object(c.createElement)(x,{trackedCompletedActions:O}),onClick:()=>{b("marketing"),Object(_.updateQueryString)({task:"marketing"})},completed:!!Z.length&&O.includes("marketing")||!$.length,visible:window.wcAdminFeatures&&window.wcAdminFeatures["remote-free-extensions"]&&(!!$.length||!!Z.length),time:Object(n.__)("1 minute","woocommerce-admin"),type:"setup"},{key:"appearance",title:Object(n.__)("Personalize my store","woocommerce-admin"),content:Object(n.__)("Add your logo, create a homepage, and start designing your store.","woocommerce-admin"),container:Object(c.createElement)(w,null),action:Object(n.__)("Let's go","woocommerce-admin"),onClick:()=>{b("appearance"),Object(_.updateQueryString)({task:"appearance"})},completed:E,visible:!0,time:Object(n.__)("2 minutes","woocommerce-admin"),type:"setup"}],K=Object(u.applyFilters)("woocommerce_admin_onboarding_task_list",Q,d);for(const e of K)e.level=e.level?parseInt(e.level,10):3;return Object(je.a)(K,"type","extension")}({activePlugins:h,countryCode:j,createNotice:o,freeExtensions:k,installAndActivatePlugins:g,installedPlugins:E,isJetpackConnected:S,onboardingStatus:f,profileItems:v,query:t,toggleCartModal:H,onTaskSelect:t=>{const o=(t=>{const o=e.task_list_tracked_started_tasks;return o&&o[t]?o[t]:0})(t);Object(l.recordEvent)("tasklist_click",{task_name:t}),(e=>!!O&&O.includes(e))(t)||((t,o)=>{const c=e.task_list_tracked_started_tasks||{};e.updateUserPreferences({task_list_tracked_started_tasks:{...c||{},[t]:o}})})(t,o+1)},hasCompleteAddress:M,trackedCompletedActions:B}),{extension:z,setup:Y}=J,{task:V}=t,Z=Array.isArray(z)&&z.sort(ke),$=(e=>{const{task:o}=t,c=e.find(e=>e.key===o);return c||null})([...Z||[],...Y||[]]);if(V&&!$)return null;if($)return Object(c.createElement)(ve,{taskContainer:$.container,query:t});if(G)return Object(c.createElement)(Ce.a,null);const Q="extended_task_list"===window.location.hash.substr(1);return Object(c.createElement)(c.Fragment,null,Y&&(!C||V)&&(D?Object(c.createElement)(Ce.a,null):Object(c.createElement)(Se,{name:"task_list",eventName:"tasklist",expandingItems:"treatment"===(null==q?void 0:q.variationName),dismissedTasks:N||[],remindMeLaterTasks:P||[],isComplete:A,query:t,tasks:Y,title:Object(n.__)("Get ready to start selling","woocommerce-admin"),trackedCompletedTasks:O||[],onComplete:()=>b({woocommerce_default_homepage_layout:"two_columns"}),onHide:()=>b({woocommerce_default_homepage_layout:"two_columns"})})),Z&&Object(c.createElement)(fe.a,null,Object(c.createElement)(a.MenuGroup,{className:"woocommerce-layout__homescreen-display-options",label:Object(n.__)("Display","woocommerce-admin")},Object(c.createElement)(a.MenuItem,{className:"woocommerce-layout__homescreen-extension-tasklist-toggle",icon:!I&&s.a,isSelected:!I,role:"menuitemcheckbox",onClick:()=>{const e=!I;Object(l.recordEvent)(e?"extended_tasklist_hide":"extended_tasklist_show"),b({woocommerce_extended_task_list_hidden:e?"yes":"no"})}},Object(n.__)("Show things to do next","woocommerce-admin")))),Z&&!I&&(Q?Object(c.createElement)(d.ScrollTo,{offset:"-20"},W(Z)):W(Z)),F&&Object(c.createElement)(p.a,{onClose:()=>H(),onClickPurchaseLater:()=>H()}))}}}]);